<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loan Calculator with Sliders and Pie Chart</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    .slider-value {
      font-weight: bold;
    }
  </style>
</head>
<body>
<div class="container mt-5">
  <h1 class="text-center">Loan Calculator</h1>
  <div class="row justify-content-center">
    <div class="col-md-6">
      <!-- Loan Calculator Form -->
      <form id="loan-form">
        <div class="mb-3">
          <label for="loanAmount" class="form-label">Loan Amount ($): <span id="loanAmountValue" class="slider-value">5000</span></label>
          <input type="range" class="form-range" id="loanAmount" min="1000" max="50000" step="500" value="5000">
        </div>
        <div class="mb-3">
          <label for="interestRate" class="form-label">Annual Interest Rate (%): <span id="interestRateValue" class="slider-value">5</span></label>
          <input type="range" class="form-range" id="interestRate" min="1" max="20" step="0.1" value="5">
        </div>
        <div class="mb-3">
          <label for="loanTenure" class="form-label">Loan Tenure (Years): <span id="loanTenureValue" class="slider-value">5</span></label>
          <input type="range" class="form-range" id="loanTenure" min="1" max="30" step="1" value="5">
        </div>
      </form>
    </div>
  </div>

  <!-- Results Section -->
  <div class="row justify-content-center mt-4">
    <div class="col-md-6">
      <h4>Results</h4>
      <ul class="list-group">
        <li class="list-group-item">Total EMI (Monthly Payment): <strong>$<span id="monthlyEMI">0</span></strong></li>
        <li class="list-group-item">Total Interest Paid: <strong>$<span id="totalInterest">0</span></strong></li>
        <li class="list-group-item">Total Amount Paid: <strong>$<span id="totalAmountPaid">0</span></strong></li>
      </ul>
    </div>
  </div>

  <!-- Chart Section -->
  <div class="row justify-content-center mt-4">
    <div class="col-md-6">
      <canvas id="loanChart"></canvas>
    </div>
  </div>
</div>

<script>
  // DOM Elements
  const loanAmountSlider = document.getElementById('loanAmount');
  const interestRateSlider = document.getElementById('interestRate');
  const loanTenureSlider = document.getElementById('loanTenure');
  const loanAmountValue = document.getElementById('loanAmountValue');
  const interestRateValue = document.getElementById('interestRateValue');
  const loanTenureValue = document.getElementById('loanTenureValue');
  const monthlyEMI = document.getElementById('monthlyEMI');
  const totalInterest = document.getElementById('totalInterest');
  const totalAmountPaid = document.getElementById('totalAmountPaid');
  const loanChartCanvas = document.getElementById('loanChart');

  let loanChart;

  // Update Values and Recalculate
  function updateCalculator() {
    const loanAmount = parseFloat(loanAmountSlider.value);
    const annualInterestRate = parseFloat(interestRateSlider.value);
    const loanTenure = parseInt(loanTenureSlider.value);

    // Update slider display values
    loanAmountValue.textContent = loanAmount;
    interestRateValue.textContent = annualInterestRate;
    loanTenureValue.textContent = loanTenure;

    // Calculate EMI
    const monthlyRate = (annualInterestRate / 100) / 12;
    const totalPayments = loanTenure * 12;
    const monthlyPayment = loanAmount * monthlyRate / (1 - Math.pow(1 + monthlyRate, -totalPayments));
    const totalRepayment = monthlyPayment * totalPayments;
    const totalInterestPaid = totalRepayment - loanAmount;

    // Update results
    monthlyEMI.textContent = monthlyPayment.toFixed(2);
    totalInterest.textContent = totalInterestPaid.toFixed(2);
    totalAmountPaid.textContent = totalRepayment.toFixed(2);

    // Update Chart
    if (loanChart) {
      loanChart.destroy();
    }
    loanChart = new Chart(loanChartCanvas.getContext('2d'), {
      type: 'pie',
      data: {
        labels: ['Principal', 'Interest'],
        datasets: [{
          label: 'Loan Breakdown',
          data: [loanAmount, totalInterestPaid],
          backgroundColor: ['#007bff', '#ffc107'],
          hoverOffset: 4
        }]
      },
      options: {
        plugins: {
          tooltip: {
            callbacks: {
              label: function (context) {
                return context.label + ': $' + context.raw.toFixed(2);
              }
            }
          }
        }
      }
    });
  }

  // Event Listeners for Sliders
  loanAmountSlider.addEventListener('input', updateCalculator);
  interestRateSlider.addEventListener('input', updateCalculator);
  loanTenureSlider.addEventListener('input', updateCalculator);

  // Initial Calculation
  updateCalculator();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
